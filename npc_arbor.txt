//===================================================================
//= NPCs d'Arbor Ancresse - Ville Sp√©ciale
//===================================================================
//= Ville sans production, uniquement syst√®me de prosp√©rit√©
//= Les joueurs d√©posent des ressources pour d√©bloquer du contenu
//===================================================================

//===================================================================
//= Hub Principal d'Arbor Ancresse
//===================================================================
sh_fild01,150,150,4	script	Hub d'Arbor Ancresse	4_M_ORIENT02,{
	.@city = 5; // ID de la ville (5 = Arbor Ancresse)
	
	mes "[Gardien d'Arbor]";
	mes "Bienvenue √† ^00AA00Arbor Ancresse^000000,";
	mes "la cit√© mystique des anciens arbres.";
	next;
	
	mes "[Gardien d'Arbor]";
	mes "^FFAAAANotre ville a besoin de votre aide !^000000";
	mes " ";
	mes "En apportant des ressources,";
	mes "vous contribuez √† la prosp√©rit√©";
	mes "et d√©bloquez de nouveaux contenus.";
	next;
	
	while(1) {
		switch(select("üìä Statut de la ville", "üìà Niveaux de prosp√©rit√©", "‚ùì Comment √ßa marche ?", "Quitter")) {
		case 1:
			// Afficher le statut actuel
			mes "[Gardien d'Arbor]";
			mes "^00AA00=== Statut d'Arbor Ancresse ===^000000";
			mes " ";
			
			// R√©cup√©rer le niveau actuel
			.@currentLevel = $ArborProsperityLevel;
			mes "^FF6600Niveau de Prosp√©rit√© :^000000 " + .@currentLevel + "/10";
			mes "^0099FFStatut :^000000 " + getvariableofnpc(.LevelNames$[.@currentLevel], "ArborConfig");
			mes " ";
			
			// Afficher les ressources actuelles
			mes "^00AA00Ressources accumul√©es :^000000";
			for (.@i = 0; .@i < 10; .@i++) {
				.@amount = $ArborResource[.@i];
				.@itemId = getvariableofnpc(.ResourceItems[.@i], "ArborConfig");
				.@itemName$ = getitemname(.@itemId);
				mes " ‚Ä¢ " + .@itemName$ + " : ^0099FF" + .@amount + "^000000";
			}
			mes " ";
			mes "^FFAA00Colis en stock :^000000 ^00FF00" + $ArborPackages + "^000000 / " + getvariableofnpc(.MaxPackages, "ArborConfig");
			next;
			break;
			
		case 2:
			// Afficher les paliers
			mes "[Gardien d'Arbor]";
			mes "^00AA00=== Paliers de Prosp√©rit√© ===^000000";
			mes " ";
			
			for (.@i = 0; .@i < 10; .@i++) {
				.@status$ = (.@i <= $ArborProsperityLevel) ? "^00FF00‚úì^000000" : "^FF0000‚úó^000000";
				.@levelName$ = getvariableofnpc(.LevelNames$[.@i], "ArborConfig");
				mes .@status$ + " Niveau " + .@i + " : " + .@levelName$;
				
				if (.@i == $ArborProsperityLevel + 1) {
					mes "   ^777777(Prochain objectif)^000000";
				}
			}
			next;
			
			// Afficher les pr√©requis du prochain niveau
			if ($ArborProsperityLevel < 9) {
				.@nextLevel = $ArborProsperityLevel + 1;
				mes "[Gardien d'Arbor]";
				mes "^FFAAAAPour atteindre le niveau " + .@nextLevel + " :^000000";
				mes " ";
				
				for (.@i = 0; .@i < 10; .@i++) {
					.@required = getvariableofnpc(.LevelRequirements[.@nextLevel * 10 + .@i], "ArborConfig");
					if (.@required > 0) {
						.@current = $ArborResource[.@i];
						.@itemId = getvariableofnpc(.ResourceItems[.@i], "ArborConfig");
						.@itemName$ = getitemname(.@itemId);
						.@color$ = (.@current >= .@required) ? "^00FF00" : "^FF6600";
						mes " ‚Ä¢ " + .@itemName$ + " : " + .@color$ + .@current + "/" + .@required + "^000000";
					}
				}
				next;
			} else {
				mes "[Gardien d'Arbor]";
				mes "^00FF00F√©licitations !^000000";
				mes "Arbor Ancresse a atteint";
				mes "son niveau maximum !";
				next;
			}
			break;
			
		case 3:
			// Explication
			mes "[Gardien d'Arbor]";
			mes "^00AA00Comment contribuer ?^000000";
			mes " ";
			mes "1. Collectez les ressources n√©cessaires";
			mes "2. Parlez au ^0099FFD√©p√¥t de Ressources^000000";
			mes "3. D√©posez vos ressources";
			mes "4. La prosp√©rit√© augmente automatiquement !";
			next;
			
			mes "[Gardien d'Arbor]";
			mes "^FFAAAAR√©compenses :^000000";
			mes " ";
			mes "Chaque niveau d√©bloque :";
			mes " ‚Ä¢ De nouveaux NPCs";
			mes " ‚Ä¢ Des warps vers de nouvelles zones";
			mes " ‚Ä¢ Des boutiques exclusives";
			mes " ‚Ä¢ Et bien plus encore !";
			next;
			break;
			
		case 4:
			mes "[Gardien d'Arbor]";
			mes "Que les arbres anciens";
			mes "vous prot√®gent, voyageur.";
			close;
		}
	}
}

//===================================================================
//= D√©p√¥t de Ressources d'Arbor Ancresse
//===================================================================
sh_fild01,145,150,4	script	D√©p√¥t de Ressources	4_M_03,{
	.@city = 5; // ID de la ville
	
	mes "[Intendant des Ressources]";
	mes "Je g√®re les ressources";
	mes "d'Arbor Ancresse.";
	mes " ";
	mes "Vous pouvez contribuer de deux fa√ßons :";
	mes "^00AA00‚Ä¢ Prosp√©rit√© :^000000 d√©velopper la ville";
	mes "^FFAA00‚Ä¢ Production :^000000 cr√©er des colis";
	next;
	
	switch(select("üìà Contribuer √† la prosp√©rit√©", "üì¶ Cr√©er des colis", "‚ùå Annuler")) {
	case 1:
		// Syst√®me de prosp√©rit√© (ancien code)
		callsub S_DepositForProsperity;
		break;
		
	case 2:
		// Nouveau syst√®me de production de colis
		callsub S_DepositForProduction;
		break;
		
	case 3:
		mes "[Intendant des Ressources]";
		mes "Tr√®s bien. Revenez quand";
		mes "vous serez pr√™t √† contribuer.";
		close;
	}
	
	end;
	
S_DepositForProsperity:
	
	// Menu de d√©p√¥t
	mes "[Intendant des Ressources]";
	mes "Quelle ressource souhaitez-vous d√©poser ?";
	mes " ";
	mes "^777777(Vous pouvez d√©poser autant que vous voulez)^000000";
	next;
	
	// Cr√©er le menu dynamique
	.@menu$ = "";
	for (.@i = 0; .@i < 10; .@i++) {
		.@itemId = getvariableofnpc(.ResourceItems[.@i], "ArborConfig");
		.@itemName$ = getitemname(.@itemId);
		.@count = countitem(.@itemId);
		.@menu$ += .@itemName$ + " (" + .@count + " en inventaire):";
	}
	.@menu$ += "Annuler";
	
	.@choice = select(.@menu$) - 1;
	
	if (.@choice == 10) {
		mes "[Intendant des Ressources]";
		mes "Tr√®s bien.";
		close;
	}
	
	// R√©cup√©rer l'item s√©lectionn√©
	.@itemId = getvariableofnpc(.ResourceItems[.@choice], "ArborConfig");
	.@itemName$ = getitemname(.@itemId);
	.@count = countitem(.@itemId);
	
	if (.@count == 0) {
		mes "[Intendant des Ressources]";
		mes "Vous n'avez pas de ^FF6600" + .@itemName$ + "^000000";
		mes "dans votre inventaire.";
		close;
	}
	
	mes "[Intendant des Ressources]";
	mes "Combien de ^0099FF" + .@itemName$ + "^000000";
	mes "souhaitez-vous d√©poser ?";
	mes " ";
	mes "^777777(Vous en avez : " + .@count + ")^000000";
	next;
	
	input .@amount;
	
	if (.@amount <= 0) {
		mes "[Intendant des Ressources]";
		mes "Montant invalide.";
		close;
	}
	
	if (.@amount > .@count) {
		mes "[Intendant des Ressources]";
		mes "Vous n'avez pas assez de ressources.";
		close;
	}
	
	// Retirer les items et ajouter √† la prosp√©rit√©
	delitem .@itemId, .@amount;
	$ArborResource[.@choice] += .@amount;
	
	mes "[Intendant des Ressources]";
	mes "^00FF00Merci pour votre contribution !^000000";
	mes " ";
	mes "Vous avez d√©pos√© ^0099FF" + .@amount + " " + .@itemName$ + "^000000.";
	
	// V√©rifier si on peut monter de niveau
	callfunc("CheckArborProsperity");
	
	next;
	mes "[Intendant des Ressources]";
	mes "La prosp√©rit√© d'Arbor Ancresse";
	mes "est maintenant √† :";
	mes "^00AA00Niveau " + $ArborProsperityLevel + "/10^000000";
	close;
	
S_DepositForProduction:
	mes "[Intendant des Ressources]";
	mes "^FFAA00=== Production de Colis ===^000000";
	mes " ";
	mes "Les colis sont cr√©√©s √† partir";
	mes "des ressources d√©pos√©es.";
	mes " ";
	.@rate = getvariableofnpc(.ProductionRate, "ArborConfig");
	mes "^777777Taux : " + .@rate + " ressources = 1 colis^000000";
	next;
	
	// V√©rifier si on a atteint la limite
	.@maxPackages = getvariableofnpc(.MaxPackages, "ArborConfig");
	if ($ArborPackages >= .@maxPackages) {
		mes "[Intendant des Ressources]";
		mes "^FF0000Attention !^000000";
		mes "Nous avons atteint notre capacit√©";
		mes "de stockage de colis.";
		mes " ";
		mes "Veuillez livrer des colis aux";
		mes "avant-postes avant d'en cr√©er d'autres.";
		close;
	}
	
	mes "[Intendant des Ressources]";
	mes "Quelle ressource souhaitez-vous d√©poser ?";
	next;
	
	// Cr√©er le menu dynamique
	.@menu$ = "";
	for (.@i = 0; .@i < 10; .@i++) {
		.@itemId = getvariableofnpc(.ResourceItems[.@i], "ArborConfig");
		.@itemName$ = getitemname(.@itemId);
		.@count = countitem(.@itemId);
		.@menu$ += .@itemName$ + " (" + .@count + " en inventaire):";
	}
	.@menu$ += "Annuler";
	
	.@choice = select(.@menu$) - 1;
	
	if (.@choice == 10) {
		mes "[Intendant des Ressources]";
		mes "Tr√®s bien.";
		close;
	}
	
	// R√©cup√©rer l'item s√©lectionn√©
	.@itemId = getvariableofnpc(.ResourceItems[.@choice], "ArborConfig");
	.@itemName$ = getitemname(.@itemId);
	.@count = countitem(.@itemId);
	
	if (.@count == 0) {
		mes "[Intendant des Ressources]";
		mes "Vous n'avez pas de ^FF6600" + .@itemName$ + "^000000";
		mes "dans votre inventaire.";
		close;
	}
	
	mes "[Intendant des Ressources]";
	mes "Combien de ^0099FF" + .@itemName$ + "^000000";
	mes "souhaitez-vous d√©poser ?";
	mes " ";
	mes "^777777(Vous en avez : " + .@count + ")^000000";
	next;
	
	input .@amount;
	
	if (.@amount <= 0) {
		mes "[Intendant des Ressources]";
		mes "Montant invalide.";
		close;
	}
	
	if (.@amount > .@count) {
		mes "[Intendant des Ressources]";
		mes "Vous n'avez pas assez de ressources.";
		close;
	}
	
	// Retirer les items et ajouter aux r√©serves de production
	delitem .@itemId, .@amount;
	$ArborProductionReserve += .@amount;
	
	mes "[Intendant des Ressources]";
	mes "^00FF00Merci pour votre contribution !^000000";
	mes " ";
	mes "Vous avez d√©pos√© ^0099FF" + .@amount + " " + .@itemName$ + "^000000.";
	mes "R√©serves de production : ^FFAA00" + $ArborProductionReserve + "^000000";
	
	// V√©rifier si on peut cr√©er des colis
	.@rate = getvariableofnpc(.ProductionRate, "ArborConfig");
	.@newPackages = 0;
	
	while ($ArborProductionReserve >= .@rate && $ArborPackages < .@maxPackages) {
		$ArborProductionReserve -= .@rate;
		$ArborPackages++;
		.@newPackages++;
	}
	
	if (.@newPackages > 0) {
		next;
		mes "[Intendant des Ressources]";
		mes "^00FF00‚ú® " + .@newPackages + " colis cr√©√©(s) !^000000";
		mes " ";
		mes "Colis en stock : ^00AA00" + $ArborPackages + "^000000 / " + .@maxPackages;
	}
	
	close;
}

//===================================================================
//= Boutique de Ressources d'Arbor Ancresse
//===================================================================
sh_fild01,155,150,4	script	Marchand d'Arbor	4_M_RACHMAN1,{
	mes "[Marchand d'Arbor]";
	mes "Bienvenue !";
	mes "Je vends les ressources";
	mes "n√©cessaires √† la prosp√©rit√©";
	mes "d'Arbor Ancresse.";
	next;
	
	if (select("üõí Acheter des ressources", "Quitter") == 2) {
		mes "[Marchand d'Arbor]";
		mes "√Ä bient√¥t !";
		close;
	}
	
	// Menu d'achat
	.@menu$ = "";
	for (.@i = 0; .@i < 10; .@i++) {
		.@itemId = getvariableofnpc(.ResourceItems[.@i], "ArborConfig");
		.@itemName$ = getitemname(.@itemId);
		.@price = getvariableofnpc(.ResourcePrice, "ArborConfig");
		.@menu$ += .@itemName$ + " (" + .@price + "z):";
	}
	.@menu$ += "Annuler";
	
	.@choice = select(.@menu$) - 1;
	
	if (.@choice == 10) {
		mes "[Marchand d'Arbor]";
		mes "√Ä bient√¥t !";
		close;
	}
	
	.@itemId = getvariableofnpc(.ResourceItems[.@choice], "ArborConfig");
	.@itemName$ = getitemname(.@itemId);
	.@price = getvariableofnpc(.ResourcePrice, "ArborConfig");
	
	mes "[Marchand d'Arbor]";
	mes "Combien de ^0099FF" + .@itemName$ + "^000000";
	mes "voulez-vous acheter ?";
	mes " ";
	mes "^777777Prix : " + .@price + "z par unit√©^000000";
	next;
	
	input .@amount;
	
	if (.@amount <= 0) {
		mes "[Marchand d'Arbor]";
		mes "Montant invalide.";
		close;
	}
	
	.@totalCost = .@amount * .@price;
	
	if (Zeny < .@totalCost) {
		mes "[Marchand d'Arbor]";
		mes "Vous n'avez pas assez de Zeny.";
		mes "Co√ªt total : ^FF6600" + .@totalCost + "z^000000";
		close;
	}
	
	Zeny -= .@totalCost;
	getitem .@itemId, .@amount;
	
	mes "[Marchand d'Arbor]";
	mes "^00FF00Transaction r√©ussie !^000000";
	mes " ";
	mes "Vous avez achet√© ^0099FF" + .@amount + " " + .@itemName$ + "^000000";
	mes "pour ^FFAAAA" + .@totalCost + "z^000000.";
	close;
}

//===================================================================
//= Point de Livraison d'Arbor Ancresse
//===================================================================
sh_fild01,150,145,4	script	Point de Livraison	4_M_MANAGER,{
	mes "[Coordinateur de Livraison]";
	mes "Bienvenue au point de livraison";
	mes "d'Arbor Ancresse.";
	mes " ";
	mes "Les colis doivent √™tre livr√©s";
	mes "aux avant-postes dans les alentours.";
	next;
	
	while(1) {
		switch(select("üì¶ R√©cup√©rer un colis", "üó∫Ô∏è Liste des avant-postes", "üìä Statut des avant-postes", "Quitter")) {
		case 1:
			// R√©cup√©rer un colis
			if ($ArborPackages <= 0) {
				mes "[Coordinateur de Livraison]";
				mes "^FF6600D√©sol√©...^000000";
				mes "Il n'y a aucun colis disponible";
				mes "pour le moment.";
				mes " ";
				mes "Demandez aux joueurs de d√©poser";
				mes "des ressources pour la production !";
				next;
				break;
			}
			
			// V√©rifier si le joueur a d√©j√† un colis
			if (#arbor_transport_active) {
				mes "[Coordinateur de Livraison]";
				mes "^FF0000Vous avez d√©j√† un colis en cours !^000000";
				mes " ";
				mes "Veuillez livrer votre colis actuel";
				mes "√† un avant-poste avant d'en";
				mes "prendre un autre.";
				next;
				break;
			}
			
			// Donner le colis au joueur
			$ArborPackages--;
			.@packageItem = getvariableofnpc(.PackageItemID, "ArborConfig");
			getitem .@packageItem, 1;
			
			// Enregistrer le transport
			#arbor_transport_active = 1;
			
			mes "[Coordinateur de Livraison]";
			mes "^00FF00Colis r√©cup√©r√© !^000000";
			mes " ";
			mes "Vous pouvez livrer ce colis";
			mes "√† ^0099FFn'importe quel avant-poste^000000";
			mes "de votre choix.";
			mes " ";
			mes "Parlez au commandant de l'avant-poste";
			mes "pour effectuer la livraison.";
			
			dispbottom "[Arbor] Livrez le colis √† un avant-poste de votre choix !";
			next;
			break;
			
		case 2:
			// Liste des avant-postes
			mes "[Coordinateur de Livraison]";
			mes "^00AA00=== Avant-Postes Disponibles ===^000000";
			mes " ";
			
			.@totalOutposts = getvariableofnpc(.TotalOutposts, "ArborConfig");
			.@hasUnlocked = 0;
			
			for (.@i = 0; .@i < .@totalOutposts; .@i++) {
				if ($ArborOutpostUnlocked[.@i]) {
					.@hasUnlocked = 1;
					.@name$ = getvariableofnpc(.OutpostNames$[.@i], "ArborConfig");
					.@map$ = getvariableofnpc(.OutpostMaps$[.@i], "ArborConfig");
					.@level = $ArborOutpostLevel[.@i];
					mes "^00FF00‚úì^000000 ^0099FF" + .@name$ + "^000000";
					mes "    Map : " + .@map$;
					mes "    Niveau : " + .@level + "/10";
					mes " ";
				} else {
					.@unlockLevel = getvariableofnpc(.OutpostUnlockLevel[.@i], "ArborConfig");
					mes "^FF0000‚úó^000000 ^777777Avant-poste verrouill√©^000000";
					mes "    ^777777(Arbor niveau " + .@unlockLevel + " requis)^000000";
					mes " ";
				}
			}
			
			if (!.@hasUnlocked) {
				mes "^FF6600Aucun avant-poste d√©bloqu√© !^000000";
				mes "D√©veloppez Arbor Ancresse pour";
				mes "d√©bloquer des avant-postes.";
			}
			
			next;
			break;
			
		case 3:
			// Statut des avant-postes
			mes "[Coordinateur de Livraison]";
			
			// V√©rifier s'il y a des avant-postes d√©bloqu√©s
			.@totalOutposts = getvariableofnpc(.TotalOutposts, "ArborConfig");
			.@hasUnlocked = 0;
			for (.@i = 0; .@i < .@totalOutposts; .@i++) {
				if ($ArborOutpostUnlocked[.@i]) {
					.@hasUnlocked = 1;
					break;
				}
			}
			
			if (!.@hasUnlocked) {
				mes "^FF6600Aucun avant-poste disponible !^000000";
				mes " ";
				mes "D√©veloppez la prosp√©rit√© d'Arbor Ancresse";
				mes "pour d√©bloquer des avant-postes.";
				next;
				break;
			}
			
			mes "Quel avant-poste voulez-vous consulter ?";
			next;
			
			// Cr√©er le menu avec seulement les avant-postes d√©bloqu√©s
			.@menu$ = "";
			cleararray .@outpostMap[0], 0, 10;
			.@menuIndex = 0;
			
			for (.@i = 0; .@i < .@totalOutposts; .@i++) {
				if ($ArborOutpostUnlocked[.@i]) {
					.@name$ = getvariableofnpc(.OutpostNames$[.@i], "ArborConfig");
					.@menu$ += .@name$ + ":";
					.@outpostMap[.@menuIndex] = .@i;
					.@menuIndex++;
				}
			}
			.@menu$ += "Annuler";
			
			.@choice = select(.@menu$) - 1;
			
			if (.@choice >= .@menuIndex) {
				next;
				break;
			}
			
			// R√©cup√©rer le vrai ID de l'avant-poste
			.@outpostId = .@outpostMap[.@choice];
			
			.@name$ = getvariableofnpc(.OutpostNames$[.@outpostId], "ArborConfig");
			.@level = $ArborOutpostLevel[.@outpostId];
			.@deliveries = $ArborOutpostDeliveries[.@outpostId];
			
			mes "[Coordinateur de Livraison]";
			mes "^00AA00=== " + .@name$ + " ===^000000";
			mes " ";
			mes "Niveau actuel : ^0099FF" + .@level + "/10^000000";
			mes "Livraisons totales : ^00FF00" + .@deliveries + "^000000";
			mes " ";
			
			if (.@level < 10) {
				.@nextLevel = .@level + 1;
				.@required = getvariableofnpc(.OutpostLevelRequirements[.@nextLevel], "ArborConfig");
				mes "Pour le niveau " + .@nextLevel + " :";
				mes "^FFAA00" + .@deliveries + " / " + .@required + " livraisons^000000";
				mes " ";
				mes "^777777Niveau " + .@nextLevel + " d√©bloquera du contenu...^000000";
			} else {
				mes "^00FF00Niveau maximum atteint !^000000";
			}
			
			next;
			break;
			
		case 4:
			mes "[Coordinateur de Livraison]";
			mes "Bonne route !";
			close;
		}
	}
}

//===================================================================
//= Configuration d'Arbor Ancresse
//===================================================================
-	script	ArborConfig	FAKE_NPC,{
OnInit:
	// ============================================
	// üìã CONFIGURATION DES RESSOURCES
	// ============================================
	
	// IDs des items de ressources (10 types)
	setarray .ResourceItems[0],
		7201,  // 0: Log (Bois)
		517,   // 1: Meat (Nourriture)
		1011,  // 2: Emveretarcon (Cuivre)
		7220,  // 3: Cloth (Tissu) - √Ä √âDITER
		7053,  // 4: Spice (√âpice) - √Ä √âDITER
		7321,  // 5: Crystal Fragment - √Ä √âDITER
		1010,  // 6: Phracon (Fer) - √Ä √âDITER
		7020,  // 7: Silk - √Ä √âDITER
		7223,  // 8: Fur - √Ä √âDITER
		7038;  // 9: Hard Skin - √Ä √âDITER
	
	// Prix d'achat dans la boutique
	.ResourcePrice = 1500;
	
	// ============================================
	// ÔøΩ CONFIGURATION DE LA PRODUCTION DE COLIS
	// ============================================
	
	// Taux de production (ressources -> colis)
	.ProductionRate = 10; // 10 ressources = 1 colis
	
	// Limite de stockage de colis
	.MaxPackages = 30; // Maximum 30 colis en stock
	
	// ID de l'item colis
	.PackageItemID = 7420; // Giftbox
	
	// ============================================
	// üó∫Ô∏è CONFIGURATION DES AVANT-POSTES
	// ============================================
	// Les avant-postes sont les destinations pour les livraisons
	// Chaque avant-poste a son propre syst√®me de prosp√©rit√©
	
	.TotalOutposts = 3; // Nombre d'avant-postes (√Ä MODIFIER selon vos besoins)
	
	// Noms des avant-postes
	setarray .OutpostNames$[0],
		"Camp du Nord",      // Avant-poste 0
		"Relais de l'Est",   // Avant-poste 1
		"Forteresse du Sud"; // Avant-poste 2
	
	// Maps des avant-postes (√Ä MODIFIER avec vos vraies maps)
	setarray .OutpostMaps$[0],
		"sh_fild16",  // Avant-poste 0
		"sh_fild16",  // Avant-poste 1
		"sh_fild16";  // Avant-poste 2
	
	// Coordonn√©es des NPCs de r√©ception (x, y altern√©s)
	setarray .OutpostCoords[0],
		100, 100,  // Avant-poste 0 (x, y)
		150, 150,  // Avant-poste 1 (x, y)
		200, 200;  // Avant-poste 2 (x, y)
	
	// Livraisons requises pour chaque niveau (0-10)
	// Chaque avant-poste monte de niveau selon le nombre de livraisons
	setarray .OutpostLevelRequirements[0],
		0,    // Niveau 0 (d√©but)
		5,    // Niveau 1 : 5 livraisons
		15,   // Niveau 2 : 15 livraisons
		30,   // Niveau 3 : 30 livraisons
		50,   // Niveau 4 : 50 livraisons
		75,   // Niveau 5 : 75 livraisons
		105,  // Niveau 6 : 105 livraisons
		140,  // Niveau 7 : 140 livraisons
		180,  // Niveau 8 : 180 livraisons
		225,  // Niveau 9 : 225 livraisons
		300;  // Niveau 10 : 300 livraisons
	
	// Noms des niveaux pour les avant-postes
	setarray .OutpostLevelNames$[0],
		"Campement Abandonn√©",
		"Avant-poste Rudimentaire",
		"Poste de Garde",
		"Fortin √âtabli",
		"Bastion Renforc√©",
		"Garnison Fortifi√©e",
		"Citadelle Imprenable",
		"Forteresse Majestueuse",
		"Bastion L√©gendaire",
		"Place Forte Mythique",
		"Sanctuaire √âternel";
	
	// ============================================	// üîì D√âBLOQUAGE DES AVANT-POSTES
	// ============================================
	// D√©finit quel niveau de prosp√©rit√© d'Arbor d√©bloque chaque avant-poste
	// .OutpostUnlockLevel[avant-poste_id] = niveau_arbor_requis
	
	setarray .OutpostUnlockLevel[0],
		2,  // Avant-poste 0 : d√©bloqu√© au niveau 2 d'Arbor
		2,  // Avant-poste 1 : d√©bloqu√© au niveau 2 d'Arbor
		5;  // Avant-poste 2 : d√©bloqu√© au niveau 5 d'Arbor
	
	// ‚ö†Ô∏è Si vous ajoutez des avant-postes, ajoutez leur niveau de d√©bloquage ici
	// Exemple pour 5 avant-postes :
	// setarray .OutpostUnlockLevel[0], 2, 2, 4, 6, 8;
	
	// ============================================	// ÔøΩüìà NIVEAUX DE PROSP√âRIT√â (10 niveaux)
	// ============================================
	
	// Noms des niveaux
	setarray .LevelNames$[0],
		"Ruines Oubli√©es",        // Niveau 0
		"Premi√®res Pousses",      // Niveau 1
		"Village Naissant",       // Niveau 2
		"Communaut√© √âtablie",     // Niveau 3
		"Cit√© en Croissance",     // Niveau 4
		"Ville Prosp√®re",         // Niveau 5
		"M√©tropole Florissante",  // Niveau 6
		"Capitale Rayonnante",    // Niveau 7
		"Empire √âclatant",        // Niveau 8
		"L√©gende √âternelle";      // Niveau 9
	
	// ============================================
	// üéØ PR√âREQUIS PAR NIVEAU
	// ============================================
	// Format : .LevelRequirements[niveau * 10 + ressource_id] = quantit√©
	// Niveau 0 : aucun pr√©requis (d√©j√† atteint)
	
	// NIVEAU 1 : Premi√®res Pousses
	.LevelRequirements[10] = 50;   // 50 Bois
	.LevelRequirements[11] = 30;   // 30 Nourriture
	.LevelRequirements[12] = 20;   // 20 Cuivre
	
	// NIVEAU 2 : Village Naissant (√Ä √âDITER)
	.LevelRequirements[20] = 100;  // Bois
	.LevelRequirements[21] = 80;   // Nourriture
	.LevelRequirements[22] = 50;   // Cuivre
	.LevelRequirements[23] = 30;   // Tissu
	
	// NIVEAU 3 : Communaut√© √âtablie (√Ä √âDITER)
	.LevelRequirements[30] = 200;
	.LevelRequirements[31] = 150;
	.LevelRequirements[32] = 100;
	.LevelRequirements[33] = 80;
	.LevelRequirements[34] = 50;   // √âpice
	
	// NIVEAU 4 : Cit√© en Croissance (√Ä √âDITER)
	.LevelRequirements[40] = 350;
	.LevelRequirements[41] = 300;
	.LevelRequirements[42] = 200;
	.LevelRequirements[43] = 150;
	.LevelRequirements[44] = 100;
	.LevelRequirements[45] = 80;   // Crystal
	
	// NIVEAU 5 : Ville Prosp√®re (√Ä √âDITER)
	.LevelRequirements[50] = 500;
	.LevelRequirements[51] = 450;
	.LevelRequirements[52] = 350;
	.LevelRequirements[53] = 300;
	.LevelRequirements[54] = 200;
	.LevelRequirements[55] = 150;
	.LevelRequirements[56] = 100;  // Fer
	
	// NIVEAU 6 : M√©tropole Florissante (√Ä √âDITER)
	.LevelRequirements[60] = 750;
	.LevelRequirements[61] = 700;
	.LevelRequirements[62] = 550;
	.LevelRequirements[63] = 500;
	.LevelRequirements[64] = 400;
	.LevelRequirements[65] = 300;
	.LevelRequirements[66] = 200;
	.LevelRequirements[67] = 150;  // Soie
	
	// NIVEAU 7 : Capitale Rayonnante (√Ä √âDITER)
	.LevelRequirements[70] = 1000;
	.LevelRequirements[71] = 950;
	.LevelRequirements[72] = 800;
	.LevelRequirements[73] = 750;
	.LevelRequirements[74] = 650;
	.LevelRequirements[75] = 500;
	.LevelRequirements[76] = 400;
	.LevelRequirements[77] = 300;
	.LevelRequirements[78] = 200;  // Fourrure
	
	// NIVEAU 8 : Empire √âclatant (√Ä √âDITER)
	.LevelRequirements[80] = 1500;
	.LevelRequirements[81] = 1400;
	.LevelRequirements[82] = 1200;
	.LevelRequirements[83] = 1100;
	.LevelRequirements[84] = 1000;
	.LevelRequirements[85] = 850;
	.LevelRequirements[86] = 700;
	.LevelRequirements[87] = 550;
	.LevelRequirements[88] = 400;
	.LevelRequirements[89] = 300;  // Hard Skin
	
	// NIVEAU 9 : L√©gende √âternelle (√Ä √âDITER)
	.LevelRequirements[90] = 2000;
	.LevelRequirements[91] = 1900;
	.LevelRequirements[92] = 1700;
	.LevelRequirements[93] = 1600;
	.LevelRequirements[94] = 1500;
	.LevelRequirements[95] = 1300;
	.LevelRequirements[96] = 1100;
	.LevelRequirements[97] = 900;
	.LevelRequirements[98] = 700;
	.LevelRequirements[99] = 500;
	
	// Initialiser le niveau de prosp√©rit√© si pas d√©j√† fait
	if (!$ArborProsperityInitialized) {
		$ArborProsperityLevel = 0;
		$ArborProsperityInitialized = 1;
		
		// Initialiser toutes les ressources √† 0
		for (.@i = 0; .@i < 10; .@i++) {
			$ArborResource[.@i] = 0;
		}
		
		// Initialiser la production
		$ArborPackages = 0;
		$ArborProductionReserve = 0;
		
		// Initialiser les avant-postes
		for (.@i = 0; .@i < .TotalOutposts; .@i++) {
			$ArborOutpostLevel[.@i] = 0;
			$ArborOutpostDeliveries[.@i] = 0;
			$ArborOutpostUnlocked[.@i] = 0; // Tous les avant-postes sont verrouill√©s au d√©part
		}
		
		announce "Le syst√®me de prosp√©rit√© d'Arbor Ancresse a √©t√© initialis√© !", bc_all, 0x00AA00;
	}
	
	// V√©rifier et d√©bloquer les avant-postes selon le niveau actuel d'Arbor
	callfunc("CheckArborOutpostUnlock");
	
	end;

OnLevelUp:
	// Cette fonction est appel√©e quand Arbor monte de niveau
	// D√©bloquer automatiquement les avant-postes
	callfunc("CheckArborOutpostUnlock");
	
	// Utilisez $ArborProsperityLevel pour activer/d√©sactiver du contenu
	// Exemple d'utilisation :
	// if ($ArborProsperityLevel >= 1) {
	//     enablenpc "NPC_Special";
	// }
	// if ($ArborProsperityLevel >= 5) {
	//     enablenpc "Warp_Special";
	// }
	
	end;
	
OnOutpostUnlock:
	// Cette fonction est appel√©e quand un avant-poste est d√©bloqu√©
	// Activer automatiquement les NPCs correspondants
	
	.@outpostId = $@ArborOutpostUnlocked;
	
	// ACTIVEZ VOS NPCs ICI selon l'ID de l'avant-poste
	// Utilisez les noms EXACTS de vos NPCs
	
	if (.@outpostId == 0) {
		// Avant-poste 0 : Camp du Nord
		enablenpc "Commandant du Camp";
		enablenpc "Marchand du Camp";
		// Ajoutez d'autres NPCs de cet avant-poste ici
	}
	
	if (.@outpostId == 1) {
		// Avant-poste 1 : Relais de l'Est
		enablenpc "Chef du Relais";
		// Ajoutez d'autres NPCs de cet avant-poste ici
	}
	
	if (.@outpostId == 2) {
		// Avant-poste 2 : Forteresse du Sud
		enablenpc "Capitaine de la Forteresse";
		// Ajoutez d'autres NPCs de cet avant-poste ici
	}
	
	// Exemple pour d'autres avant-postes :
	// if (.@outpostId == 3) {
	//     enablenpc "Votre_NPC_Avant_Poste_3";
	// }
	
	end;
	
OnOutpostLevelUp:
	// Cette fonction est appel√©e quand un avant-poste monte de niveau
	// Utilisez $@ArborOutpostLevelUp pour savoir quel avant-poste a level up
	// Utilisez $ArborOutpostLevel[id] pour conna√Ætre le niveau actuel
	
	.@outpostId = $@ArborOutpostLevelUp;
	.@level = $ArborOutpostLevel[.@outpostId];
	
	// Exemple d'utilisation pour d√©bloquer du contenu selon le niveau de l'avant-poste :
	// if (.@outpostId == 0 && .@level >= 3) {
	//     enablenpc "Warp_Donjon_Nord";
	//     announce "Le Donjon du Nord est maintenant accessible !", bc_all, 0xFFAA00;
	// }
	// if (.@outpostId == 1 && .@level >= 5) {
	//     enablenpc "Shop_Special_Est";
	//     announce "La boutique sp√©ciale de l'Est est ouverte !", bc_all, 0xFFAA00;
	// }
	// if (.@outpostId == 2 && .@level >= 7) {
	//     enablenpc "Boss_Raid_Sud";
	//     announce "Un boss raid appara√Æt au Sud !", bc_all, 0xFF0000;
	// }
	
	end;
}

//===================================================================
//= Fonction de D√©bloquage des Avant-Postes
//===================================================================
function	script	CheckArborOutpostUnlock	{
	// V√©rifier tous les avant-postes et d√©bloquer ceux qui remplissent les conditions
	.@currentLevel = $ArborProsperityLevel;
	.@totalOutposts = getvariableofnpc(.TotalOutposts, "ArborConfig");
	
	for (.@i = 0; .@i < .@totalOutposts; .@i++) {
		.@requiredLevel = getvariableofnpc(.OutpostUnlockLevel[.@i], "ArborConfig");
		
		// Si l'avant-poste n'est pas encore d√©bloqu√© et que le niveau est atteint
		if (!$ArborOutpostUnlocked[.@i] && .@currentLevel >= .@requiredLevel) {
			$ArborOutpostUnlocked[.@i] = 1;
			
			.@outpostName$ = getvariableofnpc(.OutpostNames$[.@i], "ArborConfig");
			announce "üó∫Ô∏è Nouvel avant-poste d√©bloqu√© : " + .@outpostName$ + " !", bc_all, 0x00AAFF;
			
			// Activer les NPCs de l'avant-poste
			setd "$@ArborOutpostUnlocked", .@i;
			donpcevent "ArborConfig::OnOutpostUnlock";
		}
	}
	
	return;
}

//===================================================================
//= Fonction de V√©rification de la Prosp√©rit√©
//===================================================================
function	script	CheckArborProsperity	{
	// V√©rifier si on peut monter de niveau
	while ($ArborProsperityLevel < 9) {
		.@nextLevel = $ArborProsperityLevel + 1;
		.@canLevelUp = 1;
		
		// V√©rifier tous les pr√©requis du niveau suivant
		for (.@i = 0; .@i < 10; .@i++) {
			.@required = getvariableofnpc(.LevelRequirements[.@nextLevel * 10 + .@i], "ArborConfig");
			.@current = $ArborResource[.@i];
			
			if (.@required > 0 && .@current < .@required) {
				.@canLevelUp = 0;
				break;
			}
		}
		
		// Si tous les pr√©requis sont remplis, monter de niveau
		if (.@canLevelUp) {
			$ArborProsperityLevel = .@nextLevel;
			.@levelName$ = getvariableofnpc(.LevelNames$[.@nextLevel], "ArborConfig");
			
			announce "üéâ Arbor Ancresse a atteint le niveau " + .@nextLevel + " : " + .@levelName$ + " !", bc_all, 0x00FF00;
			
			// D√©clencher l'√©v√©nement de niveau
			donpcevent "ArborConfig::OnLevelUp";
		} else {
			break;
		}
	}
	
	return;
}

//===================================================================
//= Fonction de Livraison aux Avant-Postes
//===================================================================
function	script	CompleteOutpostDelivery	{
	// Param√®tre : .@outpostId (ID de l'avant-poste)
	.@outpostId = getarg(0);
	
	// V√©rifier si le joueur a bien un transport actif
	if (!#arbor_transport_active) {
		return 0;
	}
	
	// V√©rifier si le joueur a le colis
	.@packageItem = getvariableofnpc(.PackageItemID, "ArborConfig");
	if (countitem(.@packageItem) < 1) {
		return 0;
	}
	
	// Retirer le colis
	delitem .@packageItem, 1;
	
	// Incr√©menter les livraisons de l'avant-poste
	$ArborOutpostDeliveries[.@outpostId]++;
	
	// R√©initialiser le transport du joueur
	#arbor_transport_active = 0;
	
	// V√©rifier si l'avant-poste peut monter de niveau
	.@currentLevel = $ArborOutpostLevel[.@outpostId];
	.@deliveries = $ArborOutpostDeliveries[.@outpostId];
	
	if (.@currentLevel < 10) {
		.@nextLevel = .@currentLevel + 1;
		.@required = getvariableofnpc(.OutpostLevelRequirements[.@nextLevel], "ArborConfig");
		
		if (.@deliveries >= .@required) {
			$ArborOutpostLevel[.@outpostId] = .@nextLevel;
			
			.@name$ = getvariableofnpc(.OutpostNames$[.@outpostId], "ArborConfig");
			.@levelName$ = getvariableofnpc(.OutpostLevelNames$[.@nextLevel], "ArborConfig");
			
			announce "üéâ " + .@name$ + " a atteint le niveau " + .@nextLevel + " : " + .@levelName$ + " !", bc_all, 0xFFAA00;
			
			// D√©clencher l'√©v√©nement de niveau d'avant-poste
			setd "$@ArborOutpostLevelUp", .@outpostId;
			donpcevent "ArborConfig::OnOutpostLevelUp";
		}
	}
	
	return 1;
}

//===================================================================
//= Fonction d'Annulation de Transport
//===================================================================
function	script	CancelOutpostTransport	{
	if (#arbor_transport_active) {
		.@packageItem = getvariableofnpc(.PackageItemID, "ArborConfig");
		
		// Retirer le colis s'il l'a encore
		if (countitem(.@packageItem) > 0) {
			delitem .@packageItem, 1;
		}
		
		// R√©initialiser la variable
		#arbor_transport_active = 0;
		
		dispbottom "[Arbor] Votre transport a √©t√© annul√©.";
	}
	
	return;
}

//===================================================================
//= Panel Admin - Syst√®me Arbor Ancresse
//===================================================================
sh_fild01,155,155,4	script	Panel Admin Arbor	4_M_MANAGER,{
	// V√©rification GM (changez le niveau selon vos besoins)
	if (getgmlevel() < 80) {
		mes "[???]";
		mes "...";
		close;
	}
	
	mes "[^FF0000Admin Panel^000000]";
	mes "Gestion du syst√®me Arbor Ancresse";
	mes " ";
	mes "^FF6600Niveau Arbor :^000000 " + $ArborProsperityLevel + "/10";
	mes "^00AA00Colis en stock :^000000 " + $ArborPackages;
	next;
	
	while(1) {
		switch(select("üìä Prosp√©rit√© d'Arbor", "üó∫Ô∏è Avant-Postes", "üì¶ Ressources & Colis", "üîÑ R√©initialiser", "‚ùå Quitter")) {
		case 1:
			// Gestion de la prosp√©rit√© d'Arbor
			mes "[Admin Panel]";
			mes "^FF6600Niveau actuel d'Arbor :^000000 " + $ArborProsperityLevel + "/10";
			mes " ";
			mes "Que voulez-vous faire ?";
			next;
			
			switch(select("‚¨ÜÔ∏è Augmenter niveau", "‚¨áÔ∏è Diminuer niveau", "üéØ D√©finir niveau", "‚¨ÖÔ∏è Retour")) {
			case 1:
				if ($ArborProsperityLevel >= 10) {
					mes "[Admin Panel]";
					mes "^FF0000Niveau maximum atteint !^000000";
					next;
					break;
				}
				$ArborProsperityLevel++;
				callfunc("CheckArborOutpostUnlock");
				announce "[Admin] Arbor Ancresse a atteint le niveau " + $ArborProsperityLevel + " !", bc_all, 0xFF6600;
				mes "[Admin Panel]";
				mes "^00FF00Niveau augment√© !^000000";
				mes "Nouveau niveau : " + $ArborProsperityLevel;
				next;
				break;
				
			case 2:
				if ($ArborProsperityLevel <= 0) {
					mes "[Admin Panel]";
					mes "^FF0000Niveau minimum atteint !^000000";
					next;
					break;
				}
				$ArborProsperityLevel--;
				mes "[Admin Panel]";
				mes "^00FF00Niveau diminu√© !^000000";
				mes "Nouveau niveau : " + $ArborProsperityLevel;
				next;
				break;
				
			case 3:
				mes "[Admin Panel]";
				mes "Entrez le nouveau niveau (0-10) :";
				input .@newLevel;
				
				if (.@newLevel < 0 || .@newLevel > 10) {
					mes "[Admin Panel]";
					mes "^FF0000Niveau invalide !^000000";
					next;
					break;
				}
				
				$ArborProsperityLevel = .@newLevel;
				callfunc("CheckArborOutpostUnlock");
				announce "[Admin] Arbor Ancresse est maintenant au niveau " + $ArborProsperityLevel + " !", bc_all, 0xFF6600;
				mes "[Admin Panel]";
				mes "^00FF00Niveau d√©fini !^000000";
				mes "Nouveau niveau : " + $ArborProsperityLevel;
				next;
				break;
				
			case 4:
				break;
			}
			break;
			
		case 2:
			// Gestion des avant-postes
			mes "[Admin Panel]";
			mes "^00AA00=== Gestion des Avant-Postes ===^000000";
			mes " ";
			
			.@totalOutposts = getvariableofnpc(.TotalOutposts, "ArborConfig");
			for (.@i = 0; .@i < .@totalOutposts; .@i++) {
				.@name$ = getvariableofnpc(.OutpostNames$[.@i], "ArborConfig");
				.@unlocked$ = ($ArborOutpostUnlocked[.@i]) ? "^00FF00‚úì^000000" : "^FF0000‚úó^000000";
				mes .@unlocked$ + " " + .@name$ + " (Niv. " + $ArborOutpostLevel[.@i] + ", " + $ArborOutpostDeliveries[.@i] + " livr.)";
			}
			next;
			
			mes "[Admin Panel]";
			mes "S√©lectionnez un avant-poste :";
			next;
			
			// Cr√©er le menu
			.@menu$ = "";
			for (.@i = 0; .@i < .@totalOutposts; .@i++) {
				.@name$ = getvariableofnpc(.OutpostNames$[.@i], "ArborConfig");
				.@menu$ += .@name$ + ":";
			}
			.@menu$ += "Retour";
			
			.@choice = select(.@menu$) - 1;
			
			if (.@choice >= .@totalOutposts) {
				break;
			}
			
			// Gestion de l'avant-poste s√©lectionn√©
			.@name$ = getvariableofnpc(.OutpostNames$[.@choice], "ArborConfig");
			
			mes "[Admin Panel]";
			mes "^0099FF" + .@name$ + "^000000";
			mes " ";
			mes "D√©bloqu√© : " + (($ArborOutpostUnlocked[.@choice]) ? "^00FF00Oui^000000" : "^FF0000Non^000000");
			mes "Niveau : " + $ArborOutpostLevel[.@choice] + "/10";
			mes "Livraisons : " + $ArborOutpostDeliveries[.@choice];
			next;
			
			switch(select("‚¨ÜÔ∏è Ajouter 10 livraisons", "üéØ D√©finir livraisons", "üîì Toggle D√©bloquage", "üîÑ Reset avant-poste", "‚¨ÖÔ∏è Retour")) {
			case 1:
				$ArborOutpostDeliveries[.@choice] += 10;
				callfunc("CompleteOutpostDelivery", .@choice); // V√©rifier level up
				mes "[Admin Panel]";
				mes "^00FF00+10 livraisons ajout√©es !^000000";
				mes "Total : " + $ArborOutpostDeliveries[.@choice];
				next;
				break;
				
			case 2:
				mes "[Admin Panel]";
				mes "Entrez le nombre de livraisons :";
				input .@deliveries;
				
				if (.@deliveries < 0) {
					mes "[Admin Panel]";
					mes "^FF0000Nombre invalide !^000000";
					next;
					break;
				}
				
				$ArborOutpostDeliveries[.@choice] = .@deliveries;
				
				// Recalculer le niveau
				.@level = 0;
				for (.@i = 10; .@i >= 1; .@i--) {
					.@required = getvariableofnpc(.OutpostLevelRequirements[.@i], "ArborConfig");
					if (.@deliveries >= .@required) {
						.@level = .@i;
						break;
					}
				}
				$ArborOutpostLevel[.@choice] = .@level;
				
				mes "[Admin Panel]";
				mes "^00FF00Livraisons d√©finies !^000000";
				mes "Livraisons : " + .@deliveries;
				mes "Niveau calcul√© : " + .@level;
				next;
				break;
				
			case 3:
				if ($ArborOutpostUnlocked[.@choice]) {
					$ArborOutpostUnlocked[.@choice] = 0;
					mes "[Admin Panel]";
					mes "^FF6600Avant-poste verrouill√© !^000000";
				} else {
					$ArborOutpostUnlocked[.@choice] = 1;
					setd "$@ArborOutpostUnlocked", .@choice;
					donpcevent "ArborConfig::OnOutpostUnlock";
					mes "[Admin Panel]";
					mes "^00FF00Avant-poste d√©bloqu√© !^000000";
				}
				next;
				break;
				
			case 4:
				$ArborOutpostLevel[.@choice] = 0;
				$ArborOutpostDeliveries[.@choice] = 0;
				$ArborOutpostUnlocked[.@choice] = 0;
				mes "[Admin Panel]";
				mes "^00FF00Avant-poste r√©initialis√© !^000000";
				next;
				break;
				
			case 5:
				break;
			}
			break;
			
		case 3:
			// Gestion des ressources et colis
			mes "[Admin Panel]";
			mes "^FFAA00=== Ressources & Colis ===^000000";
			mes " ";
			mes "Colis en stock : " + $ArborPackages;
			mes "R√©serves de production : " + $ArborProductionReserve;
			next;
			
			switch(select("üì¶ Ajouter colis", "üåæ Ajouter ressources", "üíé Ajouter ressources prosp√©rit√©", "‚¨ÖÔ∏è Retour")) {
			case 1:
				mes "[Admin Panel]";
				mes "Combien de colis ajouter ?";
				input .@amount;
				
				if (.@amount <= 0) {
					mes "[Admin Panel]";
					mes "^FF0000Montant invalide !^000000";
					next;
					break;
				}
				
				$ArborPackages += .@amount;
				mes "[Admin Panel]";
				mes "^00FF00" + .@amount + " colis ajout√©s !^000000";
				mes "Total : " + $ArborPackages;
				next;
				break;
				
			case 2:
				mes "[Admin Panel]";
				mes "Combien de ressources de production ajouter ?";
				input .@amount;
				
				if (.@amount <= 0) {
					mes "[Admin Panel]";
					mes "^FF0000Montant invalide !^000000";
					next;
					break;
				}
				
				$ArborProductionReserve += .@amount;
				mes "[Admin Panel]";
				mes "^00FF00" + .@amount + " ressources ajout√©es !^000000";
				mes "Total : " + $ArborProductionReserve;
				next;
				break;
				
			case 3:
				mes "[Admin Panel]";
				mes "Quelle ressource ?";
				next;
				
				.@menu$ = "";
				for (.@i = 0; .@i < 10; .@i++) {
					.@itemId = getvariableofnpc(.ResourceItems[.@i], "ArborConfig");
					.@itemName$ = getitemname(.@itemId);
					.@menu$ += .@itemName$ + " (" + $ArborResource[.@i] + "):";
				}
				.@menu$ += "Annuler";
				
				.@choice = select(.@menu$) - 1;
				
				if (.@choice == 10) {
					break;
				}
				
				mes "[Admin Panel]";
				mes "Combien ajouter ?";
				input .@amount;
				
				if (.@amount <= 0) {
					mes "[Admin Panel]";
					mes "^FF0000Montant invalide !^000000";
					next;
					break;
				}
				
				$ArborResource[.@choice] += .@amount;
				callfunc("CheckArborProsperity");
				
				mes "[Admin Panel]";
				mes "^00FF00" + .@amount + " ressources ajout√©es !^000000";
				next;
				break;
				
			case 4:
				break;
			}
			break;
			
		case 4:
			// R√©initialisation
			mes "[Admin Panel]";
			mes "^FF0000ATTENTION !^000000";
			mes " ";
			mes "Voulez-vous vraiment r√©initialiser";
			mes "tout le syst√®me Arbor Ancresse ?";
			next;
			
			if (select("Non", "Oui, r√©initialiser") == 1) {
				mes "[Admin Panel]";
				mes "Annul√©.";
				next;
				break;
			}
			
			// R√©initialisation compl√®te
			$ArborProsperityLevel = 0;
			$ArborPackages = 0;
			$ArborProductionReserve = 0;
			
			for (.@i = 0; .@i < 10; .@i++) {
				$ArborResource[.@i] = 0;
			}
			
			.@totalOutposts = getvariableofnpc(.TotalOutposts, "ArborConfig");
			for (.@i = 0; .@i < .@totalOutposts; .@i++) {
				$ArborOutpostLevel[.@i] = 0;
				$ArborOutpostDeliveries[.@i] = 0;
				$ArborOutpostUnlocked[.@i] = 0;
			}
			
			announce "[Admin] Le syst√®me Arbor Ancresse a √©t√© r√©initialis√© !", bc_all, 0xFF0000;
			
			mes "[Admin Panel]";
			mes "^00FF00Syst√®me r√©initialis√© !^000000";
			next;
			break;
			
		case 5:
			mes "[Admin Panel]";
			mes "√Ä bient√¥t !";
			close;
		}
	}
}

