//===================================================================
//= Template NPCs pour les Avant-Postes d'Arbor Ancresse
//===================================================================
//= ‚ö†Ô∏è INSTRUCTIONS :
//= 1. Copiez ce fichier pour chaque avant-poste
//= 2. Modifiez les coordonn√©es selon votre configuration
//= 3. Changez l'ID de l'avant-poste (.@outpostId)
//= 4. Personnalisez les dialogues si n√©cessaire
//= 5. Les NPCs sont initialement DISABLED (invisibles) et activ√©s automatiquement
//=    par ArborConfig::OnOutpostUnlock quand Arbor atteint le niveau requis
//= 6. IMPORTANT : Les noms des NPCs doivent correspondre exactement √† ceux
//=    configur√©s dans ArborConfig::OnOutpostUnlock (npc_arbor.txt)
//===================================================================

//===================================================================
//= AVANT-POSTE 0 : Camp du Nord (sh_fild16)
//===================================================================

// NPC de R√©ception des Livraisons
// IMPORTANT : Ce NPC est disabled par d√©faut et sera activ√© quand Arbor atteindra le niveau requis
sh_fild16,100,100,4	script	Commandant du Camp	4_M_JOB_KNIGHT1,{
	.@outpostId = 0; // ID de cet avant-poste (0, 1, 2...)
	
	// V√©rifier si l'avant-poste est d√©bloqu√©
	if (!$ArborOutpostUnlocked[.@outpostId]) {
		mes "[???]";
		mes "Cette zone n'est pas encore accessible.";
		mes " ";
		mes "^777777D√©veloppez la prosp√©rit√© d'Arbor Ancresse";
		mes "pour d√©bloquer cet avant-poste.^000000";
		close;
	}
	
	mes "[Commandant du Camp]";
	mes "Bienvenue au ^00AA00Camp du Nord^000000,";
	mes "avant-poste d'Arbor Ancresse.";
	next;
	
	while(1) {
		switch(select("üì¶ Livrer un colis", "üìä Statut de l'avant-poste", "üéÅ R√©compenses", "Quitter")) {
		case 1:
			// Livraison
			if (!#arbor_transport_active) {
				mes "[Commandant du Camp]";
				mes "Vous n'avez pas de colis en cours de transport.";
				mes " ";
				mes "R√©cup√©rez un colis au Point de Livraison";
				mes "√† Arbor Ancresse pour commencer.";
				next;
				break;
			}
			
			// Effectuer la livraison
			if (callfunc("CompleteOutpostDelivery", .@outpostId)) {
				mes "[Commandant du Camp]";
				mes "^00FF00Livraison r√©ussie !^000000";
				mes " ";
				mes "Merci pour votre contribution.";
				mes "L'avant-poste se d√©veloppe gr√¢ce √† vous !";
				
				// R√©compenses
				.@reward = 3000 + ($ArborOutpostLevel[.@outpostId] * 500);
				.@exp = 500 + ($ArborOutpostLevel[.@outpostId] * 100);
				
				Zeny += .@reward;
				getexp .@exp, 0;
				
				next;
				mes "[Commandant du Camp]";
				mes "^FFAAAAR√©compenses :^000000";
				mes " ‚Ä¢ Zeny : ^00FF00" + .@reward + "z^000000";
				mes " ‚Ä¢ Exp : ^0099FF" + .@exp + "^000000";
				mes " ";
				mes "Livraisons totales : ^FFAA00" + $ArborOutpostDeliveries[.@outpostId] + "^000000";
				next;
			} else {
				mes "[Commandant du Camp]";
				mes "^FF0000Erreur lors de la livraison.^000000";
				next;
			}
			break;
			
		case 2:
			// Statut
			mes "[Commandant du Camp]";
			mes "^00AA00=== Statut du Camp du Nord ===^000000";
			mes " ";
			
			.@level = $ArborOutpostLevel[.@outpostId];
			.@deliveries = $ArborOutpostDeliveries[.@outpostId];
			.@levelName$ = getvariableofnpc(.OutpostLevelNames$[.@level], "ArborConfig");
			
			mes "Niveau actuel : ^0099FF" + .@level + "/10^000000";
			mes "Statut : ^00AA00" + .@levelName$ + "^000000";
			mes "Livraisons totales : ^FFAA00" + .@deliveries + "^000000";
			mes " ";
			
			if (.@level < 10) {
				.@nextLevel = .@level + 1;
				.@required = getvariableofnpc(.OutpostLevelRequirements[.@nextLevel], "ArborConfig");
				.@nextLevelName$ = getvariableofnpc(.OutpostLevelNames$[.@nextLevel], "ArborConfig");
				
				mes "^FFAAAAProchain niveau :^000000";
				mes .@nextLevelName$ + " (Niv. " + .@nextLevel + ")";
				mes "Progression : ^00FF00" + .@deliveries + " / " + .@required + "^000000";
			} else {
				mes "^00FF00Niveau maximum atteint !^000000";
			}
			
			next;
			break;
			
		case 3:
			// R√©compenses d√©bloqu√©es
			mes "[Commandant du Camp]";
			mes "^00AA00=== Contenu D√©bloqu√© ===^000000";
			mes " ";
			
			.@level = $ArborOutpostLevel[.@outpostId];
			
			mes "Niveau " + .@level + " atteint :";
			mes " ";
			
			// Personnalisez selon vos contenus
			if (.@level >= 1) mes "^00FF00‚úì^000000 Acc√®s au campement";
			else mes "^FF0000‚úó^000000 Acc√®s au campement (Niv. 1)";
			
			if (.@level >= 3) mes "^00FF00‚úì^000000 Boutique de base";
			else mes "^FF0000‚úó^000000 Boutique de base (Niv. 3)";
			
			if (.@level >= 5) mes "^00FF00‚úì^000000 Warp vers Grotte Nord";
			else mes "^FF0000‚úó^000000 Warp vers Grotte Nord (Niv. 5)";
			
			if (.@level >= 7) mes "^00FF00‚úì^000000 Boutique avanc√©e";
			else mes "^FF0000‚úó^000000 Boutique avanc√©e (Niv. 7)";
			
			if (.@level >= 10) mes "^00FF00‚úì^000000 Donjon L√©gendaire";
			else mes "^FF0000‚úó^000000 Donjon L√©gendaire (Niv. 10)";
			
			next;
			break;
			
		case 4:
			mes "[Commandant du Camp]";
			mes "Bonne route, voyageur !";
			close;
		}
	}
	
OnInit:
	// D√©sactiver ce NPC au d√©marrage
	// Il sera activ√© par ArborConfig::OnOutpostUnlock
	disablenpc "Commandant du Camp";
	end;
}

// Exemple de NPC qui se d√©bloque selon le niveau de l'avant-poste
sh_fild16,105,100,4	script	Marchand du Camp	4_M_01,{
	.@outpostId = 0;
	
	// V√©rifier si l'avant-poste est d√©bloqu√©
	if (!$ArborOutpostUnlocked[.@outpostId]) {
		mes "[Marchand]";
		mes "...";
		close;
	}
	
	.@level = $ArborOutpostLevel[.@outpostId];
	
	if (.@level < 3) {
		mes "[Marchand du Camp]";
		mes "Mon √©choppe n'est pas encore";
		mes "assez d√©velopp√©e...";
		mes " ";
		mes "Revenez quand l'avant-poste";
		mes "aura atteint le ^0099FFniveau 3^000000.";
		mes " ";
		mes "^777777(Livraisons : " + $ArborOutpostDeliveries[.@outpostId] + " / " + getvariableofnpc(.OutpostLevelRequirements[3], "ArborConfig") + ")^000000";
		close;
	}
	
	mes "[Marchand du Camp]";
	mes "Bienvenue dans ma boutique !";
	mes "Que puis-je faire pour vous ?";
	next;
	
	// Votre boutique ici
	// callshop "Shop_Camp_Nord", 1;
	// npcshopattach "Shop_Camp_Nord";
	
	close;
	
OnInit:
	// D√©sactiver ce NPC au d√©marrage
	disablenpc "Marchand du Camp";
	end;
}

// Exemple de Warp qui se d√©bloque selon le niveau de l'avant-poste
sh_fild16,110,100,0	script	#warp_grotte_nord	WARPNPC,2,2,{
	.@outpostId = 0;
	
	// V√©rifier si l'avant-poste est d√©bloqu√©
	if (!$ArborOutpostUnlocked[.@outpostId]) {
		mes "Cette zone est inaccessible.";
		close;
	}
	
	.@level = $ArborOutpostLevel[.@outpostId];
	
	if (.@level < 5) {
		mes "Le passage est bloqu√©.";
		mes " ";
		mes "^777777L'avant-poste doit atteindre";
		mes "le niveau 5 pour d√©bloquer l'acc√®s.^000000";
		mes " ";
		mes "^777777(Livraisons : " + $ArborOutpostDeliveries[.@outpostId] + " / " + getvariableofnpc(.OutpostLevelRequirements[5], "ArborConfig") + ")^000000";
		close;
	}
	
	mes "Voulez-vous entrer dans la Grotte du Nord ?";
	next;
	
	if (select("Oui", "Non") == 1) {
		warp "votre_map", 100, 100; // CHANGEZ LA DESTINATION
	}
	close;
}

//===================================================================
//= AVANT-POSTE 1 : Relais de l'Est (sh_fild16)
//===================================================================

sh_fild16,150,150,4	script	Chef du Relais	4_M_JOB_KNIGHT2,{
	.@outpostId = 1; // ID de cet avant-poste
	
	// V√©rifier si l'avant-poste est d√©bloqu√©
	if (!$ArborOutpostUnlocked[.@outpostId]) {
		mes "[???]";
		mes "Cette zone n'est pas encore accessible.";
		mes " ";
		mes "^777777D√©veloppez la prosp√©rit√© d'Arbor Ancresse";
		mes "pour d√©bloquer cet avant-poste.^000000";
		close;
	}
	
	mes "[Chef du Relais]";
	mes "Bienvenue au ^00AA00Relais de l'Est^000000,";
	mes "avant-poste d'Arbor Ancresse.";
	next;
	
	while(1) {
		switch(select("üì¶ Livrer un colis", "üìä Statut de l'avant-poste", "üéÅ R√©compenses", "Quitter")) {
		case 1:
			// Livraison
			if (!#arbor_transport_active) {
				mes "[Chef du Relais]";
				mes "Vous n'avez pas de colis en cours de transport.";
				mes " ";
				mes "R√©cup√©rez un colis au Point de Livraison";
				mes "√† Arbor Ancresse pour commencer.";
				next;
				break;
			}
			
			// Effectuer la livraison
			if (callfunc("CompleteOutpostDelivery", .@outpostId)) {
				mes "[Chef du Relais]";
				mes "^00FF00Livraison r√©ussie !^000000";
				mes " ";
				mes "Merci pour votre contribution.";
				mes "L'avant-poste se d√©veloppe gr√¢ce √† vous !";
				
				// R√©compenses
				.@reward = 3000 + ($ArborOutpostLevel[.@outpostId] * 500);
				.@exp = 500 + ($ArborOutpostLevel[.@outpostId] * 100);
				
				Zeny += .@reward;
				getexp .@exp, 0;
				
				next;
				mes "[Chef du Relais]";
				mes "^FFAAAAR√©compenses :^000000";
				mes " ‚Ä¢ Zeny : ^00FF00" + .@reward + "z^000000";
				mes " ‚Ä¢ Exp : ^0099FF" + .@exp + "^000000";
				mes " ";
				mes "Livraisons totales : ^FFAA00" + $ArborOutpostDeliveries[.@outpostId] + "^000000";
				next;
			} else {
				mes "[Chef du Relais]";
				mes "^FF0000Erreur lors de la livraison.^000000";
				next;
			}
			break;
			
		case 2:
			// Statut
			mes "[Chef du Relais]";
			mes "^00AA00=== Statut du Relais de l'Est ===^000000";
			mes " ";
			
			.@level = $ArborOutpostLevel[.@outpostId];
			.@deliveries = $ArborOutpostDeliveries[.@outpostId];
			.@levelName$ = getvariableofnpc(.OutpostLevelNames$[.@level], "ArborConfig");
			
			mes "Niveau actuel : ^0099FF" + .@level + "/10^000000";
			mes "Statut : ^00AA00" + .@levelName$ + "^000000";
			mes "Livraisons totales : ^FFAA00" + .@deliveries + "^000000";
			mes " ";
			
			if (.@level < 10) {
				.@nextLevel = .@level + 1;
				.@required = getvariableofnpc(.OutpostLevelRequirements[.@nextLevel], "ArborConfig");
				.@nextLevelName$ = getvariableofnpc(.OutpostLevelNames$[.@nextLevel], "ArborConfig");
				
				mes "^FFAAAAProchain niveau :^000000";
				mes .@nextLevelName$ + " (Niv. " + .@nextLevel + ")";
				mes "Progression : ^00FF00" + .@deliveries + " / " + .@required + "^000000";
			} else {
				mes "^00FF00Niveau maximum atteint !^000000";
			}
			
			next;
			break;
			
		case 3:
			// R√©compenses d√©bloqu√©es
			mes "[Chef du Relais]";
			mes "^00AA00=== Contenu D√©bloqu√© ===^000000";
			mes " ";
			
			.@level = $ArborOutpostLevel[.@outpostId];
			
			mes "Niveau " + .@level + " atteint :";
			mes " ";
			
			// Personnalisez selon vos contenus pour cet avant-poste
			if (.@level >= 1) mes "^00FF00‚úì^000000 Acc√®s au relais";
			else mes "^FF0000‚úó^000000 Acc√®s au relais (Niv. 1)";
			
			if (.@level >= 4) mes "^00FF00‚úì^000000 Forgeron disponible";
			else mes "^FF0000‚úó^000000 Forgeron disponible (Niv. 4)";
			
			if (.@level >= 6) mes "^00FF00‚úì^000000 Warp vers For√™t de l'Est";
			else mes "^FF0000‚úó^000000 Warp vers For√™t de l'Est (Niv. 6)";
			
			if (.@level >= 8) mes "^00FF00‚úì^000000 Boutique d'enchantements";
			else mes "^FF0000‚úó^000000 Boutique d'enchantements (Niv. 8)";
			
			if (.@level >= 10) mes "^00FF00‚úì^000000 Boss Raid disponible";
			else mes "^FF0000‚úó^000000 Boss Raid disponible (Niv. 10)";
			
			next;
			break;
			
		case 4:
			mes "[Chef du Relais]";
			mes "Bonne route, voyageur !";
			close;
		}
	}
	
OnInit:
	// D√©sactiver ce NPC au d√©marrage
	disablenpc "Chef du Relais";
	end;
}

//===================================================================
//= AVANT-POSTE 2 : Forteresse du Sud (sh_fild16)
//===================================================================

sh_fild16,200,200,4	script	Capitaine de la Forteresse	4_M_KNIGHT_GOLD,{
	.@outpostId = 2; // ID de cet avant-poste
	
	// V√©rifier si l'avant-poste est d√©bloqu√©
	if (!$ArborOutpostUnlocked[.@outpostId]) {
		mes "[???]";
		mes "Cette zone n'est pas encore accessible.";
		mes " ";
		mes "^777777D√©veloppez la prosp√©rit√© d'Arbor Ancresse";
		mes "pour d√©bloquer cet avant-poste.^000000";
		close;
	}
	
	mes "[Capitaine de la Forteresse]";
	mes "Bienvenue √† la ^00AA00Forteresse du Sud^000000,";
	mes "avant-poste d'Arbor Ancresse.";
	next;
	
	while(1) {
		switch(select("üì¶ Livrer un colis", "üìä Statut de l'avant-poste", "üéÅ R√©compenses", "Quitter")) {
		case 1:
			// Livraison
			if (!#arbor_transport_active) {
				mes "[Capitaine de la Forteresse]";
				mes "Vous n'avez pas de colis en cours de transport.";
				mes " ";
				mes "R√©cup√©rez un colis au Point de Livraison";
				mes "√† Arbor Ancresse pour commencer.";
				next;
				break;
			}
			
			// Effectuer la livraison
			if (callfunc("CompleteOutpostDelivery", .@outpostId)) {
				mes "[Capitaine de la Forteresse]";
				mes "^00FF00Livraison r√©ussie !^000000";
				mes " ";
				mes "Merci pour votre contribution.";
				mes "L'avant-poste se d√©veloppe gr√¢ce √† vous !";
				
				// R√©compenses
				.@reward = 3000 + ($ArborOutpostLevel[.@outpostId] * 500);
				.@exp = 500 + ($ArborOutpostLevel[.@outpostId] * 100);
				
				Zeny += .@reward;
				getexp .@exp, 0;
				
				next;
				mes "[Capitaine de la Forteresse]";
				mes "^FFAAAAR√©compenses :^000000";
				mes " ‚Ä¢ Zeny : ^00FF00" + .@reward + "z^000000";
				mes " ‚Ä¢ Exp : ^0099FF" + .@exp + "^000000";
				mes " ";
				mes "Livraisons totales : ^FFAA00" + $ArborOutpostDeliveries[.@outpostId] + "^000000";
				next;
			} else {
				mes "[Capitaine de la Forteresse]";
				mes "^FF0000Erreur lors de la livraison.^000000";
				next;
			}
			break;
			
		case 2:
			// Statut
			mes "[Capitaine de la Forteresse]";
			mes "^00AA00=== Statut de la Forteresse du Sud ===^000000";
			mes " ";
			
			.@level = $ArborOutpostLevel[.@outpostId];
			.@deliveries = $ArborOutpostDeliveries[.@outpostId];
			.@levelName$ = getvariableofnpc(.OutpostLevelNames$[.@level], "ArborConfig");
			
			mes "Niveau actuel : ^0099FF" + .@level + "/10^000000";
			mes "Statut : ^00AA00" + .@levelName$ + "^000000";
			mes "Livraisons totales : ^FFAA00" + .@deliveries + "^000000";
			mes " ";
			
			if (.@level < 10) {
				.@nextLevel = .@level + 1;
				.@required = getvariableofnpc(.OutpostLevelRequirements[.@nextLevel], "ArborConfig");
				.@nextLevelName$ = getvariableofnpc(.OutpostLevelNames$[.@nextLevel], "ArborConfig");
				
				mes "^FFAAAAProchain niveau :^000000";
				mes .@nextLevelName$ + " (Niv. " + .@nextLevel + ")";
				mes "Progression : ^00FF00" + .@deliveries + " / " + .@required + "^000000";
			} else {
				mes "^00FF00Niveau maximum atteint !^000000";
			}
			
			next;
			break;
			
		case 3:
			// R√©compenses d√©bloqu√©es
			mes "[Capitaine de la Forteresse]";
			mes "^00AA00=== Contenu D√©bloqu√© ===^000000";
			mes " ";
			
			.@level = $ArborOutpostLevel[.@outpostId];
			
			mes "Niveau " + .@level + " atteint :";
			mes " ";
			
			// Personnalisez selon vos contenus pour cet avant-poste
			if (.@level >= 1) mes "^00FF00‚úì^000000 Acc√®s √† la forteresse";
			else mes "^FF0000‚úó^000000 Acc√®s √† la forteresse (Niv. 1)";
			
			if (.@level >= 3) mes "^00FF00‚úì^000000 Instructeur de combat";
			else mes "^FF0000‚úó^000000 Instructeur de combat (Niv. 3)";
			
			if (.@level >= 5) mes "^00FF00‚úì^000000 Warp vers Montagnes du Sud";
			else mes "^FF0000‚úó^000000 Warp vers Montagnes du Sud (Niv. 5)";
			
			if (.@level >= 7) mes "^00FF00‚úì^000000 Armurier l√©gendaire";
			else mes "^FF0000‚úó^000000 Armurier l√©gendaire (Niv. 7)";
			
			if (.@level >= 10) mes "^00FF00‚úì^000000 Donjon de la Forteresse";
			else mes "^FF0000‚úó^000000 Donjon de la Forteresse (Niv. 10)";
			
			next;
			break;
			
		case 4:
			mes "[Capitaine de la Forteresse]";
			mes "Bonne route, voyageur !";
			close;
		}
	}
	
OnInit:
	// D√©sactiver ce NPC au d√©marrage
	disablenpc "Capitaine de la Forteresse";
	end;
}

//===================================================================
//= NOTES D'UTILISATION
//===================================================================
// Variables globales disponibles pour vos scripts :
// 
// PROSP√âRIT√â D'ARBOR ANCRESSE :
// $ArborProsperityLevel            - Niveau de prosp√©rit√© d'Arbor (0-10)
//
// AVANT-POSTES :
// $ArborOutpostUnlocked[id]        - 1 si d√©bloqu√©, 0 sinon
// $ArborOutpostLevel[id]           - Niveau actuel de l'avant-poste (0-10)
// $ArborOutpostDeliveries[id]      - Nombre total de livraisons
//
// SYST√àME DE D√âBLOQUAGE :
// Les avant-postes se d√©bloquent automatiquement quand Arbor Ancresse
// atteint le niveau configur√© dans .OutpostUnlockLevel[id] (ArborConfig)
//
// Les NPCs des avant-postes sont INVISIBLES (disablenpc) au d√©marrage
// et deviennent visibles (enablenpc) automatiquement dans ArborConfig::OnOutpostUnlock
//
// ‚ö†Ô∏è IMPORTANT : Pour que vos NPCs s'activent automatiquement :
// 1. Ajoutez disablenpc "Nom_Du_NPC"; dans OnInit de chaque NPC
// 2. Ajoutez enablenpc "Nom_Du_NPC"; dans ArborConfig::OnOutpostUnlock (npc_arbor.txt)
//    selon l'ID de l'avant-poste
//
// UTILISATION DANS VOS NPCs :
// 
// 1. Cr√©er un NPC d'avant-poste invisible au d√©part :
//    sh_fild16,100,100,4  script  Mon NPC  4_M_01,{
//        .@outpostId = 0;
//        
//        if (!$ArborOutpostUnlocked[.@outpostId]) {
//            mes "Zone inaccessible.";
//            close;
//        }
//        
//        mes "Bienvenue !";
//        close;
//        
//    OnInit:
//        disablenpc "Mon NPC";  // NPC invisible au d√©part
//        end;
//    }
//
// 2. Dans npc_arbor.txt, ArborConfig::OnOutpostUnlock :
//    if (.@outpostId == 0) {
//        enablenpc "Mon NPC";  // Rendre le NPC visible
//    }
//
// 3. D√©bloquer du contenu selon le niveau de l'avant-poste :
//    Dans ArborConfig::OnOutpostLevelUp :
//    if (.@outpostId == 0 && .@level >= 5) {
//        enablenpc "Warp_Donjon_Nord";
//        announce "Le Donjon du Nord est accessible !", bc_all, 0xFFAA00;
//    }
//
// 3. D√©bloquer du contenu selon PLUSIEURS avant-postes :
//    if ($ArborOutpostLevel[0] >= 3 && $ArborOutpostLevel[1] >= 3) {
//        enablenpc "NPC_Special_Deux_Avant_Postes";
//    }
//
// 4. Dans ArborConfig::OnOutpostLevelUp, d√©bloquer automatiquement :
//    .@outpostId = $@ArborOutpostLevelUp;
//    .@level = $ArborOutpostLevel[.@outpostId];
//    
//    if (.@outpostId == 0 && .@level >= 5) {
//        enablenpc "Warp_Grotte_Nord";
//        announce "La Grotte du Nord est maintenant accessible !", bc_all, 0xFFAA00;
//    }
//
// EXEMPLE COMPLET DE D√âBLOQUAGE PROGRESSIF :
//
// Niveau Arbor 2 ‚Üí D√©bloque Avant-poste 0 et 1
// Avant-poste 0 Niv 3 ‚Üí Boutique disponible
// Avant-poste 0 Niv 5 ‚Üí Warp vers donjon
// Avant-poste 0 Niv 10 ‚Üí Boss raid
//
// Niveau Arbor 5 ‚Üí D√©bloque Avant-poste 2
// Avant-poste 2 Niv 7 ‚Üí Zone secr√®te
//
// Si Avant-poste 0 Niv 10 ET Avant-poste 2 Niv 10 ‚Üí Contenu final
//===================================================================
