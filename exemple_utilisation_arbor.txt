//===================================================================
//= EXEMPLES D'UTILISATION DU SYST√àME ARBOR ANCRESSE
//===================================================================
//= Ce fichier contient des exemples concrets pour utiliser
//= le syst√®me de d√©bloquage progressif bas√© sur la prosp√©rit√©
//===================================================================

//===================================================================
//= EXEMPLE 1 : NPC qui se d√©bloque selon Arbor
//===================================================================
// Ce NPC n'appara√Æt que quand Arbor atteint le niveau 3

sh_fild01,160,160,4	script	Sage d'Arbor	4_M_SAGE_C,{
	// V√©rifier le niveau de prosp√©rit√© d'Arbor
	if ($ArborProsperityLevel < 3) {
		mes "[???]";
		mes "...";
		close;
	}
	
	mes "[Sage d'Arbor]";
	mes "Ah, je vois que notre ville";
	mes "se d√©veloppe bien !";
	mes " ";
	mes "Gr√¢ce √† votre aide, nous avons";
	mes "atteint le niveau " + $ArborProsperityLevel + ".";
	close;
}

//===================================================================
//= EXEMPLE 2 : Warp qui se d√©bloque selon un avant-poste
//===================================================================
// Ce warp vers un donjon n'est accessible que si l'avant-poste 0
// (Camp du Nord) a atteint le niveau 5

sh_fild02,120,120,0	script	#vers_donjon_mystique	WARPNPC,2,2,{
	.@outpostId = 0; // Camp du Nord
	
	// V√©rifier si l'avant-poste est d√©bloqu√©
	if (!$ArborOutpostUnlocked[.@outpostId]) {
		mes "Le chemin est bloqu√© par des ruines.";
		close;
	}
	
	// V√©rifier le niveau de l'avant-poste
	if ($ArborOutpostLevel[.@outpostId] < 5) {
		mes "[Entr√©e du Donjon]";
		mes "Les portes sont scell√©es.";
		mes " ";
		.@deliveries = $ArborOutpostDeliveries[.@outpostId];
		.@required = getvariableofnpc(.OutpostLevelRequirements[5], "ArborConfig");
		mes "^777777Le Camp du Nord doit atteindre le niveau 5^000000";
		mes "^777777Progression : " + .@deliveries + " / " + .@required + " livraisons^000000";
		close;
	}
	
	mes "[Entr√©e du Donjon]";
	mes "Le donjon mystique vous attend.";
	mes "Voulez-vous entrer ?";
	next;
	
	if (select("Oui", "Non") == 1) {
		warp "votre_donjon_map", 100, 100; // CHANGEZ ICI
	}
	close;
}

//===================================================================
//= EXEMPLE 3 : Boutique qui se d√©bloque progressivement
//===================================================================
// Cette boutique vend plus d'items selon le niveau de l'avant-poste

sh_fild03,155,155,4	script	Marchand Sp√©cial	4_M_ALCHE_C,{
	.@outpostId = 1; // Relais de l'Est
	
	// V√©rifier si l'avant-poste est d√©bloqu√©
	if (!$ArborOutpostUnlocked[.@outpostId]) {
		mes "[Marchand]";
		mes "Je n'ai rien √† vendre pour le moment.";
		close;
	}
	
	.@level = $ArborOutpostLevel[.@outpostId];
	
	mes "[Marchand Sp√©cial]";
	mes "Bienvenue dans ma boutique !";
	mes " ";
	mes "^0099FFNiveau de l'avant-poste : " + .@level + "/10^000000";
	next;
	
	// Menu diff√©rent selon le niveau
	.@menu$ = "Items de base (Niv. 0):";
	
	if (.@level >= 3) {
		.@menu$ += "Items interm√©diaires (Niv. 3):";
	}
	
	if (.@level >= 7) {
		.@menu$ += "Items rares (Niv. 7):";
	}
	
	if (.@level >= 10) {
		.@menu$ += "Items l√©gendaires (Niv. 10):";
	}
	
	.@menu$ += "Quitter";
	
	switch(select(.@menu$)) {
	case 1:
		mes "[Marchand Sp√©cial]";
		mes "Voici les items de base.";
		// Votre boutique de base ici
		close;
		
	case 2:
		if (.@level >= 3) {
			mes "[Marchand Sp√©cial]";
			mes "Voici les items interm√©diaires.";
			// Votre boutique interm√©diaire ici
		}
		close;
		
	case 3:
		if (.@level >= 7) {
			mes "[Marchand Sp√©cial]";
			mes "Voici les items rares.";
			// Votre boutique rare ici
		}
		close;
		
	case 4:
		if (.@level >= 10) {
			mes "[Marchand Sp√©cial]";
			mes "Voici les items l√©gendaires !";
			// Votre boutique l√©gendaire ici
		}
		close;
		
	default:
		close;
	}
}

//===================================================================
//= EXEMPLE 4 : Contenu qui n√©cessite PLUSIEURS conditions
//===================================================================
// Ce NPC n'appara√Æt que si :
// - Arbor est au niveau 5
// - L'avant-poste 0 est au niveau 5
// - L'avant-poste 1 est au niveau 3

sh_fild01,165,165,4	script	Archiviste Ancien	4_M_BIBI,{
	// V√©rifications multiples
	if ($ArborProsperityLevel < 5) {
		mes "[???]";
		mes "...";
		close;
	}
	
	if (!$ArborOutpostUnlocked[0] || $ArborOutpostLevel[0] < 5) {
		mes "[Archiviste]";
		mes "Le Camp du Nord doit √™tre";
		mes "au niveau 5 pour acc√©der";
		mes "√† mes archives.";
		close;
	}
	
	if (!$ArborOutpostUnlocked[1] || $ArborOutpostLevel[1] < 3) {
		mes "[Archiviste]";
		mes "Le Relais de l'Est doit √™tre";
		mes "au niveau 3 pour acc√©der";
		mes "√† mes archives.";
		close;
	}
	
	mes "[Archiviste Ancien]";
	mes "F√©licitations !";
	mes "Vous avez d√©bloqu√© l'acc√®s";
	mes "aux archives secr√®tes.";
	mes " ";
	mes "Que voulez-vous consulter ?";
	// Votre contenu sp√©cial ici
	close;
}

//===================================================================
//= EXEMPLE 5 : Event qui se d√©clenche automatiquement
//===================================================================
// Dans ArborConfig (npc_arbor.txt), ajoutez dans OnOutpostLevelUp :

/*
OnOutpostLevelUp:
	callfunc("CheckArborOutpostUnlock");
	
	.@outpostId = $@ArborOutpostLevelUp;
	.@level = $ArborOutpostLevel[.@outpostId];
	
	// Quand le Camp du Nord atteint le niveau 5
	if (.@outpostId == 0 && .@level == 5) {
		announce "üéâ Le Donjon Mystique du Nord vient d'√™tre d√©couvert !", bc_all, 0xFF6600;
		enablenpc "#vers_donjon_mystique";
	}
	
	// Quand le Relais de l'Est atteint le niveau 7
	if (.@outpostId == 1 && .@level == 7) {
		announce "üéâ La For√™t Enchant√©e de l'Est est maintenant accessible !", bc_all, 0xFF6600;
		enablenpc "#warp_foret_enchantee";
	}
	
	// Quand la Forteresse du Sud atteint le niveau 10
	if (.@outpostId == 2 && .@level == 10) {
		announce "‚öîÔ∏è Le Boss L√©gendaire du Sud est apparu !", bc_all, 0xFF0000;
		monster "sh_fild04", 200, 200, "Titan du Sud", 1234, 1, ""; // Changez l'ID
	}
	
	// Contenu sp√©cial si TOUS les avant-postes sont au max
	if ($ArborOutpostLevel[0] == 10 && $ArborOutpostLevel[1] == 10 && $ArborOutpostLevel[2] == 10) {
		announce "üåü TOUS LES AVANT-POSTES SONT AU MAXIMUM ! LA ZONE FINALE EST D√âBLOQU√âE !", bc_all, 0xFFD700;
		enablenpc "#warp_zone_finale";
	}
	
	end;
*/

//===================================================================
//= EXEMPLE 6 : Zone secr√®te avec plusieurs pr√©requis
//===================================================================
// Cette zone n'est accessible que si certaines conditions sont remplies

-	script	#check_zone_secrete	FAKE_NPC,{
OnInit:
	// D√©sactiver le warp au d√©marrage
	disablenpc "#warp_zone_secrete";
	end;
}

sh_fild01,170,170,0	script	#warp_zone_secrete	WARPNPC,2,2,{
	// Conditions multiples
	if ($ArborProsperityLevel < 8) {
		mes "Une barri√®re magique vous emp√™che d'avancer.";
		mes " ";
		mes "^777777Arbor Ancresse doit atteindre le niveau 8.^000000";
		close;
	}
	
	.@total = 0;
	for (.@i = 0; .@i < 3; .@i++) {
		if ($ArborOutpostLevel[.@i] >= 7) {
			.@total++;
		}
	}
	
	if (.@total < 2) {
		mes "Une barri√®re magique vous emp√™che d'avancer.";
		mes " ";
		mes "^777777Au moins 2 avant-postes doivent √™tre au niveau 7.^000000";
		mes "^777777Actuellement : " + .@total + "/2^000000";
		close;
	}
	
	mes "[Portail Mystique]";
	mes "La zone secr√®te vous attend.";
	mes "Voulez-vous entrer ?";
	next;
	
	if (select("Oui", "Non") == 1) {
		warp "votre_zone_secrete", 100, 100; // CHANGEZ ICI
	}
	close;
}

//===================================================================
//= EXEMPLE 7 : NPC qui donne des qu√™tes selon la progression
//===================================================================

sh_fild01,175,175,4	script	Questeur des Avant-Postes	4_M_KHMAN,{
	mes "[Questeur]";
	mes "Bonjour aventurier !";
	mes "J'ai des missions pour vous.";
	next;
	
	.@menu$ = "";
	
	// Qu√™te 1 : Disponible si Avant-poste 0 niveau 3
	if ($ArborOutpostUnlocked[0] && $ArborOutpostLevel[0] >= 3) {
		.@menu$ += "Qu√™te : Explorer le Camp du Nord:";
	}
	
	// Qu√™te 2 : Disponible si Avant-poste 1 niveau 5
	if ($ArborOutpostUnlocked[1] && $ArborOutpostLevel[1] >= 5) {
		.@menu$ += "Qu√™te : S√©curiser le Relais de l'Est:";
	}
	
	// Qu√™te 3 : Disponible si tous les avant-postes sont d√©bloqu√©s
	if ($ArborOutpostUnlocked[0] && $ArborOutpostUnlocked[1] && $ArborOutpostUnlocked[2]) {
		.@menu$ += "Qu√™te : Unifier les Avant-Postes:";
	}
	
	.@menu$ += "Quitter";
	
	if (.@menu$ == "Quitter") {
		mes "[Questeur]";
		mes "D√©veloppez les avant-postes";
		mes "pour d√©bloquer des qu√™tes !";
		close;
	}
	
	switch(select(.@menu$)) {
	case 1:
		mes "[Questeur]";
		mes "Explorez le Camp du Nord...";
		// Votre qu√™te ici
		close;
		
	case 2:
		mes "[Questeur]";
		mes "S√©curisez le Relais de l'Est...";
		// Votre qu√™te ici
		close;
		
	case 3:
		mes "[Questeur]";
		mes "Unifiez les avant-postes...";
		// Votre qu√™te ici
		close;
		
	default:
		close;
	}
}

//===================================================================
//= R√âSUM√â DES VARIABLES UTILES
//===================================================================
/*

PROSP√âRIT√â D'ARBOR ANCRESSE :
===============================
$ArborProsperityLevel (0-10)
	- Niveau de d√©veloppement de la ville principale
	- D√©bloque les avant-postes selon .OutpostUnlockLevel[id]

$ArborResource[0-9]
	- Ressources accumul√©es pour la prosp√©rit√©
	- 10 types de ressources diff√©rents

AVANT-POSTES :
===============
$ArborOutpostUnlocked[0-2]
	- 1 si l'avant-poste est d√©bloqu√©, 0 sinon
	- D√©bloqu√© automatiquement par ArborConfig::OnOutpostUnlock

$ArborOutpostLevel[0-2] (0-10)
	- Niveau de prosp√©rit√© de chaque avant-poste
	- Monte avec les livraisons de colis

$ArborOutpostDeliveries[0-2]
	- Nombre total de livraisons effectu√©es
	- Utilis√© pour calculer le niveau de l'avant-poste

√âV√âNEMENTS :
=============
ArborConfig::OnLevelUp
	- D√©clench√© quand Arbor monte de niveau
	- $ArborProsperityLevel contient le nouveau niveau

ArborConfig::OnOutpostUnlock
	- D√©clench√© quand un avant-poste est d√©bloqu√©
	- $@ArborOutpostUnlocked contient l'ID de l'avant-poste

ArborConfig::OnOutpostLevelUp
	- D√©clench√© quand un avant-poste monte de niveau
	- $@ArborOutpostLevelUp contient l'ID de l'avant-poste
	- $ArborOutpostLevel[id] contient le nouveau niveau

*/
